name: OpenAISpans

tests:
  - name: completions
    description: whatever
    vendor: OpenAI
    endpoint: completions
    request:
      model: gpt-4o-mini
      messages:
        - role: user
          content: "What is the capital of France?"
    wiremock: |
      {
        "request": {
          "method": "POST",
          "url": "/chat/completions"
        },
        "response": {
          "status": 200,
          "headers": {
            "Content-Type": "application/json"
          },
          "body": {
            "id": "chatcmpl-test123",
            "object": "chat.completion",
            "created": 1677652288,
            "model": "gpt-4o-mini",
            "choices": [
              {
                "index": 0,
                "message": {
                  "role": "assistant",
                  "content": "The capital of France is Paris."
                },
                "finish_reason": "stop"
              }
            ],
            "usage": {
              "prompt_tokens": 20,
              "completion_tokens": 8,
              "total_tokens": 28
            }
          }
        }
      }
    resulting_span:
      span_name: OAI_40_MINI
      required_attributes:
        - name: genai.model
        - value: GPT40_MINI
